<head>
  <title>Courses</title>
  <%= stylesheet_link_tag "application", :media => "all" %>
  <%= csrf_meta_tags %>
</head>
<body>
  <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
	<a class="brand" href="/">Courses</a>
	<ul class="nav local">
	  <li><%= link_to "Departments", "/departments" %></li>
	</ul>
	<ul class="nav pull-right">
	  <li class="dropdown">
	    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
	      My Courses
	      <b class="caret"></b>
	    </a>
	    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
	      <li><a tabindex="-1">You need to be logged in<br />to view your courses.</a></li>
	    </ul>
	  </li>
	</ul>
      </div>
    </div>
  </div>
  <div id="wrap">
    <div class="container">
      <div class="s-push"></div>

      <div id="content"></div>

    </div>
    <div class="push"></div>
  </div>
  <div id="footer">
    <div class="container">
      <p class="muted credit">
	&copy; 2013 - Developed by <%= link_to "Shiva Nandan", "https://github.com/seekshiva", target: '_blank' %>.
      </p>
    </div>
  </div>


  <script type="text/template" id="departments-template">
    <table class="table table-hover">
      <thead>
	<tr>
	  <th>Name</th>
	  <th>HOD</th>
	</tr>
      </thead>
      <tbody>
	{{#each depts}}
	<tr>
	  <td>
	    <a href="#departments/{{this.id}}">{{this.name}}
	  </td>
	  <td>{{this.hod}}</td>
	</tr>
	{{/each}}
      </tbody>
    </table>
  </script>

  <script type="text/template" id="department-template">
    <h4>
      <span class="label label-info">{{dept.short}}</span>
      {{dept.name}}
    </h4>
    <div>
      Headed by <strong>{{dept.hod}}</strong>
    </div>

    <table class="table table-hover">
      <thead>
	<caption>
	  <h3>Courses Offered</h3>
	</caption>
      </thead>
      <tbody>
	{{#each dept.course_list}}
	<tr><th colspan="3">{{this.semester}}</th></tr>

	{{#each this.courses}}
	<tr>
	  <td>
	    <a href="#courses/{{this.id}}">
	      {{this.subject_code}} - {{this.name}}
	    </a>
	  </td>
	  <td>{{this.credits}}</td>
	  <td>-</td>
	</tr>
	{{/each}}

	{{/each}}
      </tbody>
    </table>
  </script>


  <script type="text/template" id="course-template">
    <h3>
      <span class="label label-info">{{course.subject_code}}</span>
      {{course.name}}
    </h3>
    <p>
      This course is being offered by {{course.departments.length}} department{{plural}}
      <strong>(
	{{#each course.departments}}
	<a href="#departments/{{this.id}}">
	  {{this.short}}
	</a>
	{{/each}}
	)</strong>
      . It is a <strong>{{course.credits}}</strong> credit course.
      {{#if course.current}}
      <div>
	Classes for this course are being held right now for {{course.current.semester}} semester students in the academic year {{course.current.year}}.
      </div>
      {{/if}}
    </p>

    <div class="s-push"></div>
    <div>
      <strong onclick="	console.log({{course.reference_books}});">Reference Books</strong>
      <table class="table table-hover">
	<tbody>
	  {{#unless course.reference_books }}
	  No reference book found for this course.
	  {{/unless}}

	  {{#each course.reference_books}}
	  <tr><td>
	      <small>
		<b><a href="#/books/{{this.id}}">{{this.title}}</a> ({{this.year}})</b>
		by
		{{#each this.authors}}
		<a href="#/authors/{{this.id}}">{{this.name}}</a>;
		{{/each}}
		<br />
		{{this.publisher}}, {{this.edition}} <b><i>{{this.isbn}}</i></b>
	      </small>
	  </td></tr>
          {{/each}}
	</tbody>
      </table>
    </div>
    <small>View by</small>
    <div class="btn-group" data-toggle="buttons-radio">
      <a href="#/courses/{{course.id}}/topics" class="btn btn-small{{topics_view_state}}" id="view_by_topic">Topics</a>
      <a href="#/courses/{{course.id}}/classes" class="btn btn-small{{classes_view_state}}" id="view_by_class">Classes</a>
    </div> 
    <div class="s-push"></div>
    <div id="specialized_view"></div>
 </script>

  
  <script type="text/template" id="course-topic-template">
    <table class="table table-bordered">
      <thead>
	<caption><h4>
	    Topics
	</h4></caption>
      </thead>
      <tbody>
	{{#each course.topics}}
	<tr><td>
	    <dl>
	      <dt>
		<a href="#/courses/{{../course.id}}/topics/{{this.id}}">{{this.title}}</a>
		<span class="label label-success">{{this.ct_status}}</span>
	      </dt>
	      <dd>
		<p>
		  <small>
		    {{#if this.classes}}
		    This topic was taught on
		    {{#each this.classes}}
		    {{this.date}}
		    {{/each}}
		    
		    {{else}}
		    This topic has not been taught so far this semester
		    {{/if}}
		  </small>
		</p>

		<p>{{this.description}}</p>
		<table class="table-hover table-bordered">
		  <thead><tr>
		      {{#each this.reference}}
		      <th><small>{{this.book}}</small></th>
		      {{/each}}
		  </tr></thead>
		  <tbody><tr>
		      {{#each this.reference}}
		      <td><small>{{this.sections}}</small></td>
		      {{/each}}
		  </tr></tbody>
		</table>
	      </dd>
	    </dl>
	</td></tr>
	{{/each}}
      </tbody>
    </table>
  </script>
  
  <script type="text/template" id="course-class-template">
    <table class="table table-bordered">
      <thead>
	<caption><h4>
	    Classes
	</h4></caption>
      </thead>
      <tbody>
	{{#unless course.classes}}
	<tr><td>
	    No classes have been taught in this course this semester.
	</td></tr>
	{{/unless}}
	{{#each course.classes}}
	<tr><td>
	    <dl>
	      <dt>
		{{this.date}} {{this.time}}
	      </dt>
	      <dd>
		at {{this.room}}<br />
		<strong>
		  Topics covered
		</strong>
		<ul>
		  {{#each this.topics}}
		  <li>
		    {{this.title}}
		  </li>
		  {{/each}}
		</ul>
	      </dd>
	    </dl>
	</td></tr>
	{{/each}}
      </tbody>
  </script>
  
  <%= javascript_include_tag "vendor" %>
  <%= javascript_include_tag "application" %>
</body>
