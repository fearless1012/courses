<% if notice %>
<div id="notice" class="alert alert-info">
  <%= notice %>
</div>
<% end %>

<div class="pull-right">
  <%= link_to 'Edit', edit_admin_course_path(@course), class: 'btn btn-small' %>
</div>

<h3>
  <span class="label label-info"><%= @course.subject_code %></span>
  <%= @course.name %>
</h3>
<p>
  This course is being offered by <%= pluralize @course.departments.length, 'department' %>

  <% if @course.departments.length > 0 %>
  <strong>(
    <% @course.departments.each do |department| %>
    <%= link_to department.short, [:admin, department] %>
    <% end %>
    ).
  </strong>
  <% end %>

  It is a <strong><%= @course.credits %></strong> credit course.
 
  <div>
    <% unless @course.current_term.nil? %>
    Classes for this course are being held right now for <%= @course.current_term.semester.ordinalize %> semester students in the academic year <%= @course.current_term.year %>.
    Classes take place at <strong><%= @course.current_term.venue %></strong>.
    <% end %>
  </div>
</p>


<div class="s-push"></div>
<div>
  <% if @course.terms.length == 0 %> 
  <strong>Terms:</strong>
  <p>No term found for this course.
    <%= link_to "Add one?", new_admin_course_term_path(@course) %>
  </p>
  <% else %>
  <table class="table table-hover">
    <thead>
      <tr>
	<th>Term</th>
	<th>Departments</th>
	<th>Faculty</th>
	<th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @course.terms.each do |term| %>
      <tr>
	<td>
	  <%= link_to "##{term.id}", [:admin, @course, term] %>
	  in <%= term.year %> for <%= term.semester.ordinalize %> semester students
	</td>
	<td>
	  <% term.term_departments.each do |t_dept| %>
	  <span class="label label-info">
	    <%= t_dept.department.short %>
	    <%= link_to raw("&times"), [:admin, @course, t_dept], method: :delete, class: "btn btn-danger btn-mini" %>
	  </span>
	  <% end %>
	</td>
	<td>
	  <% term.term_faculties.each do |t_fac| %>
	  <span class="label label-info">
	    <%= t_fac.faculty.user.email %>
	    <%= link_to raw("&times"), [:admin, @course, t_fac], method: :delete, class: "btn btn-danger btn-mini" %>
	  </span>
	  <% end %>
	</td>
	<td>
	  <a class="btn btn-small" rel="popover" data-content="Feature to add dept/faculty will come here.<br> Until then, please click the term link #id to add faculty/dept" data-html="true" data-placement="bottom">
	    Add <b class="caret"></b>
	  </a>
	</td>
      </tr>
      <% end %>
    </tbody>
  </table>
  <% end %>
</div>

<div class="s-push"></div>
<div>
  <strong>Reference Books:</strong>
  <% if @course.books.length == 0 %>
  <p>No reference book found for this subject.</p>
  <% else %>
  <table class="table table-hover" >
    <% @course.books.each do |book| %>
    <tr>
      <td>
	<small>
	  <b><%= link_to book.title, [:admin, book] %> (<%= book.year %>)</b>
	  by
	  <% book.authors.each do |author| %>
	  <%= link_to author.name, [:admin, author] %>;
	  <% end %><br />
	  
	  <%= "#{book.publisher}, #{book.edition}" %> <b><i><%= "#{book.isbn}" %></i></b>
	</small>
      </td>
    </tr>
    <% end %>
  </table>
  <% end %>
</div>

<div class="s-push"></div>
<table class="table table-bordered">
  <thead>
    <caption><h4>
	Topics
    </h4></caption>
  </thead>
  <tbody>
    <% if @course.topics.length == 0 %>
    <tr><td>
      No topic found for this course.
    </td></tr>
    <% else %>
    <% @course.topics.each do |topic| %>
    <% @topic = topic %>
    <tr><td>
	<%= render :template => "admin/topics/show" %>
	
    </td></tr>
    <% end %>
    <% end %>
  </tbody>
</table>




